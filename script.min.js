const SHEET_ID="1G1UjWN_ru3PdQf-qlKuwIT5CCfQSuA6reOzQZdu6FW8",API_KEY="AIzaSyAmOoWpQprHyZS97DiIXCdy2LFkAe0POa8",urls={navbar:`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Navbar?key=${API_KEY}`,body:`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Body?key=${API_KEY}`,header:`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Header?key=${API_KEY}`,footer:`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/Footer?key=${API_KEY}`},fetchData=async e=>{try{const t=await fetch(e);if(!t.ok)throw new Error("Failed to fetch data");return t.json()}catch(e){return console.error("Error:",e),null}},hamburger=document.getElementById("hamburger"),navLinks=document.getElementById("nav-links");hamburger.addEventListener("click",(()=>{hamburger.classList.toggle("active"),navLinks.classList.toggle("active")}));const renderNavbar=async()=>{const e=await fetchData(urls.navbar),t=document.getElementById("nav-links"),a=document.getElementById("logo-image"),n=e.values.slice(1);t.innerHTML="";const s=n.find((e=>"Logo"===e[0]));s&&(a.src=s[1],a.alt=s[2]||"Logo"),n.filter((e=>"Link"===e[0])).forEach((e=>{const a=document.createElement("a");a.href=e[2],a.textContent=e[1],a.target="_blank",t.appendChild(a)}))},renderCarousel=async()=>{const e=await fetchData(urls.header),t=document.getElementById("header-carousel"),a=document.createElement("div");a.className="carousel-dots";let n=0,s=0,r=0;const c=e.values.slice(1).map(((e,t)=>{const a=document.createElement("div");a.className="carousel-slide",a.style.backgroundImage=`url('${e[0]}')`;const n=document.createElement("div");return n.className="carousel-content",n.innerHTML=`\n            <h2>\n                <a href="${e[3]}" target="_blank">${e[1]}</a>\n            </h2>\n            <p>${e[2]}</p>\n        `,a.appendChild(n),0===t&&a.classList.add("active"),a})),o=e=>{c.forEach(((t,a)=>{a===e?t.classList.add("active"):t.classList.remove("active")})),a.children[n].classList.remove("active"),n=e,a.children[n].classList.add("active")};c.forEach(((e,t)=>{const n=document.createElement("div");n.className="carousel-dot",0===t&&n.classList.add("active"),n.addEventListener("click",(()=>{o(t)})),a.appendChild(n)})),t.append(...c,a),t.addEventListener("touchstart",(e=>{s=e.touches[0].clientX})),t.addEventListener("touchmove",(e=>{r=e.touches[0].clientX})),t.addEventListener("touchend",(()=>{if(s-r>50){const e=(n+1)%c.length;o(e)}else if(s-r<-50){const e=(n-1+c.length)%c.length;o(e)}})),setInterval((()=>{const e=(n+1)%c.length;o(e)}),5e3)},renderCards=async()=>{const e=await fetchData(urls.body),t=document.getElementById("content"),a=document.getElementById("tag-filter"),n=document.getElementById("search-bar"),s=document.getElementById("search-button"),r=[...new Set(e.values.slice(1).flatMap((e=>e[2].split(",").map((e=>e.trim())))))];a.innerHTML+=r.map((e=>`<option value="${e}">${e}</option>`)).join("");const c=(a="",n="")=>{const s=e.values.slice(1).filter((e=>{const t=e[1].toLowerCase().includes(a),s=e[3].toLowerCase().includes(a),r=e[2].toLowerCase().includes(a),c=""===n||e[2].split(",").map((e=>e.trim())).includes(n);return(t||s||r)&&c}));t.innerHTML=s.map((e=>{const t=e[2].split(",").map((e=>`<span class="card-tag">${e.trim()}</span>`)).join("");return`\n                <div class="card">\n                    <img src="${e[0]}" alt="${e[1]}">\n                    <div class="card-body">\n                        <div class="card-tags">${t}</div>\n                        <h3 class="card-title">\n                            <a href="${e[4]}" target="_blank">${e[1]}</a>\n                        </h3>\n                        <p class="card-description">${e[3]}</p>\n                    </div>\n                </div>\n            `})).join("")};s.addEventListener("click",(()=>{const e=n.value.toLowerCase(),t=a.value;c(e,t)})),n.addEventListener("input",(()=>{const e=n.value.toLowerCase(),t=a.value;c(e,t)})),a.addEventListener("change",(()=>{const e=n.value.toLowerCase(),t=a.value;c(e,t)})),c()},renderFooter=async()=>{const e=(await fetchData(urls.footer)).values.slice(1),t=document.getElementById("footer-address"),a=document.getElementById("footer-links"),n=document.getElementById("footer-contact");t.innerHTML="",a.innerHTML="",n.innerHTML="";const s=e.find((e=>"Address"===e[0]&&"Title"===e[1]))[2],r=e.find((e=>"Address"===e[0]&&"Content"===e[1]))[2];t.innerHTML=`\n        <h4>${s}</h4>\n        <p>${r}</p>\n    `;const c=e.find((e=>"Sitelink"===e[0]&&"Title"===e[1]))[2],o=e.filter((e=>"Sitelink"===e[0]&&e[1].includes("Link Text")));a.innerHTML=`<h4>${c}</h4><ul></ul>`;const l=a.querySelector("ul");o.forEach((t=>{const a=t[2],n=e.find((e=>"Sitelink"===e[0]&&e[1]===t[1].replace("Text","URL"))),s=n?n[2]:"#";l.innerHTML+=`<li><a href="${s}" target="_blank">${a}</a></li>`}));const i=e.find((e=>"Contact"===e[0]&&"Title"===e[1]))[2],d=e.find((e=>"Contact"===e[0]&&"Email Label"===e[1]))[2],u=e.find((e=>"Contact"===e[0]&&"Email Address"===e[1]))[2],h=e.find((e=>"Contact"===e[0]&&"Phone Label"===e[1]))[2],m=e.find((e=>"Contact"===e[0]&&"Phone Number"===e[1]))[2],v=e.find((e=>"Contact"===e[0]&&"Social Label"===e[1]))[2],g=e.find((e=>"Contact"===e[0]&&"Social Facebook"===e[1]))[2],p=e.find((e=>"Contact"===e[0]&&"Social Instagram"===e[1]))[2];n.innerHTML=`\n        <h4>${i}</h4>\n        <p>${d}: <a href="mailto:${u}">${u}</a></p>\n        <p>${h}: <a href="tel:${m}">${m}</a></p>\n        <p>${v}: \n            <a href="${g}" target="_blank">Facebook</a> | \n            <a href="${p}" target="_blank">Instagram</a>\n        </p>\n    `},fetchDataWithCache=async(e,t)=>{const a=localStorage.getItem(t);if(a)return JSON.parse(a);const n=await fetchData(e);return n&&localStorage.setItem(t,JSON.stringify(n)),n},init=async()=>{await renderNavbar(),await renderCarousel(),await renderCards(),await renderFooter()};init();