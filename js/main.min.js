const t="1G1UjWN_ru3PdQf-qlKuwIT5CCfQSuA6reOzQZdu6FW8";const o="AIzaSyAmOoWpQprHyZS97DiIXCdy2LFkAe0POa8";const f={t:`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/Navbar?key=${o}`,body:`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/Body?key=${o}`,o:`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/Header?key=${o}`,i:`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/Footer?key=${o}`};const k=async t=>{try{const c=await fetch(t);if(!c.ok)throw new Error("Failed to fetch data");return c.json()}catch(o){console.error("Error:",o);return null}};const c=document.getElementById("hamburger");const s=document.getElementById("nav-links");c.addEventListener("click",()=>{c.classList.toggle("active");s.classList.toggle("active")});const n=async()=>{const t=await k(f.t);const c=document.getElementById("nav-links");const o=document.getElementById("logo-image");const s=t.values.slice(1);c.innerHTML="";const n=s.find(t=>t[0]==="Logo");if(n){o.src=n[1];o.alt=n[2]||"Logo"}s.filter(t=>t[0]==="Link").forEach(t=>{const o=document.createElement("a");o.href=t[2];o.textContent=t[1];o.target="_blank";c.appendChild(o)})};const a=async()=>{const t=await k(f.o);const o=document.getElementById("header-carousel");const s=document.createElement("div");s.className="carousel-dots";let n=0;let c=0;let a=0;const e=t.values.slice(1).map((t,o)=>{const c=document.createElement("div");c.className="carousel-slide";c.style.backgroundImage=`url('${t[0]}')`;const s=document.createElement("div");s.className="carousel-content";s.innerHTML=`
            <h2>
                <a href="${t[3]}" target="_blank">${t[1]}</a>
            </h2>
            <p>${t[2]}</p>
        `;c.appendChild(s);if(o===0)c.classList.add("active");return c});const r=c=>{e.forEach((t,o)=>{if(o===c){t.classList.add("active")}else{t.classList.remove("active")}});s.children[n].classList.remove("active");n=c;s.children[n].classList.add("active")};e.forEach((t,o)=>{const c=document.createElement("div");c.className="carousel-dot";if(o===0)c.classList.add("active");c.addEventListener("click",()=>{r(o)});s.appendChild(c)});o.append(...e,s);o.addEventListener("touchstart",t=>{c=t.touches[0].clientX});o.addEventListener("touchmove",t=>{a=t.touches[0].clientX});o.addEventListener("touchend",()=>{if(c-a>50){const t=(n+1)%e.length;r(t)}else if(c-a<-50){const o=(n-1+e.length)%e.length;r(o)}});setInterval(()=>{const t=(n+1)%e.length;r(t)},5e3)};const e=async()=>{const o=await k(f.body);const c=document.getElementById("content");const s=document.getElementById("tag-filter");const n=document.getElementById("search-bar");const t=document.getElementById("search-button");const a=[...new Set(o.values.slice(1).flatMap(t=>t[2].split(",").map(t=>t.trim())))];s.innerHTML+=a.map(t=>`<option value="${t}">${t}</option>`).join("");const e=(a="",e="")=>{const t=o.values.slice(1).filter(t=>{const o=t[1].toLowerCase().includes(a);const c=t[3].toLowerCase().includes(a);const s=t[2].toLowerCase().includes(a);const n=e===""||t[2].split(",").map(t=>t.trim()).includes(e);return(o||c||s)&&n});c.innerHTML=t.map(t=>{const o=t[2].split(",").map(t=>`<span class="card-tag">${t.trim()}</span>`).join("");return`
                <div class="card">
                    <img src="${t[0]}" alt="${t[1]}">
                    <div class="card-body">
                        <div class="card-tags">${o}</div>
                        <h3 class="card-title">
                            <a href="${t[4]}" target="_blank">${t[1]}</a>
                        </h3>
                        <p class="card-description">${t[3]}</p>
                    </div>
                </div>
            `}).join("")};t.addEventListener("click",()=>{const t=n.value.toLowerCase();const o=s.value;e(t,o)});n.addEventListener("input",()=>{const t=n.value.toLowerCase();const o=s.value;e(t,o)});s.addEventListener("change",()=>{const t=n.value.toLowerCase();const o=s.value;e(t,o)});e()};const r=async()=>{const t=await k(f.i);const n=t.values.slice(1);const o=document.getElementById("footer-address");const c=document.getElementById("footer-links");const s=document.getElementById("footer-contact");o.innerHTML="";c.innerHTML="";s.innerHTML="";const a=n.find(t=>t[0]==="Address"&&t[1]==="Title")[2];const e=n.find(t=>t[0]==="Address"&&t[1]==="Content")[2];o.innerHTML=`
        <h4>${a}</h4>
        <p>${e}</p>
    `;const r=n.find(t=>t[0]==="Sitelink"&&t[1]==="Title")[2];const i=n.filter(t=>t[0]==="Sitelink"&&t[1].includes("Link Text"));c.innerHTML=`<h4>${r}</h4><ul></ul>`;const l=c.querySelector("ul");i.forEach(o=>{const t=o[2];const c=n.find(t=>t[0]==="Sitelink"&&t[1]===o[1].replace("Text","URL"));const s=c?c[2]:"#";l.innerHTML+=`<li><a href="${s}" target="_blank">${t}</a></li>`});const d=n.find(t=>t[0]==="Contact"&&t[1]==="Title")[2];const u=n.find(t=>t[0]==="Contact"&&t[1]==="Email Label")[2];const h=n.find(t=>t[0]==="Contact"&&t[1]==="Email Address")[2];const $=n.find(t=>t[0]==="Contact"&&t[1]==="Phone Label")[2];const v=n.find(t=>t[0]==="Contact"&&t[1]==="Phone Number")[2];const m=n.find(t=>t[0]==="Contact"&&t[1]==="Social Label")[2];const p=n.find(t=>t[0]==="Contact"&&t[1]==="Social Facebook")[2];const g=n.find(t=>t[0]==="Contact"&&t[1]==="Social Instagram")[2];s.innerHTML=`
        <h4>${d}</h4>
        <p>${u}: <a href="mailto:${h}">${h}</a></p>
        <p>${$}: <a href="tel:${v}">${v}</a></p>
        <p>${m}: 
            <a href="${p}" target="_blank">Facebook</a> | 
            <a href="${g}" target="_blank">Instagram</a>
        </p>
    `};const i=async(t,o)=>{const c=localStorage.getItem(o);if(c)return JSON.parse(c);const s=await k(t);if(s)localStorage.setItem(o,JSON.stringify(s));return s};const l=async()=>{await n();await a();await e();await r()};l();